<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: oAuthHelper.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: oAuthHelper.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import oauthSignature from 'oauth-signature';
import {randomBytes} from 'crypto';

/**
 * A helper for OAuth 1.0 header information and signing keys.
 */
export class OAuthHelper {
  /**
   * Intialize the helper
   * @param {string} consumerKey The consumer key
   * @param {string} token The token value
   */
  constructor(consumerKey, token) {
    /** @type {string} */
    this.consumerKey = consumerKey;
    /** @type {string} */
    this.token = token;
    /** @type {string} */
    this.nonce = randomBytes(16).toString('hex');
    /** @type {string} */
    this.signature = '';
    /** @type {string} */
    this.timestamp = Math.round(Date.now() / 1000).toString();
  }

  get parameters() {
    return {
      oauth_consumer_key: this.consumerKey,
      oauth_token: this.token,
      oauth_nonce: this.nonce,
      oauth_timestamp: this.timestamp,
      oauth_signature_method: 'HMAC-SHA1',
      oauth_version: '1.0',
    };
  }

  get header() {
    let str = 'OAuth ';

    let params = Object.assign({ realm: '' }, this.parameters);
    params['oauth_signature'] = this.signature;

    let keys = Object.keys(params);
    let pairs = keys.map((k) => {
      return k + '="' + params[k] + '"';
    });

    str += pairs.join(',');
    return str;
  }

  get queryString() {
    let params = Object.assign({}, this.parameters);
    params['oauth_signature'] = this.signature;
    let str = JSON.stringify(params);
    return 'Authorization=' + str;
  }

  /**
   * Sign the request with oath headers and sets the signature member of the OauthHelper instance.
   */
  sign(url, request, consumerSecret, tokenSecret) {
    let params = Object.assign({}, this.parameters, request.params.toObject());

    this.signature = oauthSignature.generate(
      request.method,
      url,
      params,
      consumerSecret,
      tokenSecret,
    );
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BrickLinkApiError.html">BrickLinkApiError</a></li><li><a href="BricklinkRequest.html">BricklinkRequest</a></li><li><a href="Client.html">Client</a></li><li><a href="Condition.html">Condition</a></li><li><a href="ItemType.html">ItemType</a></li><li><a href="OAuthHelper.html">OAuthHelper</a></li><li><a href="RequestParams.html">RequestParams</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Fri Jul 28 2023 21:41:54 GMT+0200 (GMT+02:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
